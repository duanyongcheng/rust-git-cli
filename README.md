# Rust Git CLI

ä¸€ä¸ªæ™ºèƒ½çš„ Git æäº¤å·¥å…·ï¼Œæ”¯æŒä¸­è‹±æ–‡åŒè¯­æäº¤ä¿¡æ¯ç”Ÿæˆã€‚

## âœ¨ ç‰¹æ€§

- ğŸ” **æ™ºèƒ½æ£€æµ‹** - è‡ªåŠ¨æ£€æµ‹ Git ä»“åº“çŠ¶æ€å’Œæœªæäº¤çš„æ›´æ”¹
- ğŸ¤– **AI ç”Ÿæˆ** - æ”¯æŒ OpenAIã€Anthropicã€DeepSeek ç­‰ AI æä¾›å•†
- ğŸŒ **åŒè¯­æ”¯æŒ** - ç”Ÿæˆä¸­è‹±æ–‡åŒè¯­çš„æäº¤ä¿¡æ¯
- ğŸ¨ **å½©è‰²è¾“å‡º** - ç¾è§‚çš„ç»ˆç«¯è¾“å‡ºï¼Œä¾¿äºé˜…è¯»
- ğŸ”§ **çµæ´»é…ç½®** - æ”¯æŒå¤šç§é…ç½®æ–¹å¼å’Œè‡ªå®šä¹‰ API ç«¯ç‚¹
- ğŸ› **è°ƒè¯•æ¨¡å¼** - å†…ç½®è°ƒè¯•åŠŸèƒ½ï¼Œæ–¹ä¾¿æ’æŸ¥é—®é¢˜
- âœ… **æ™ºèƒ½æš‚å­˜** - è‡ªåŠ¨æ£€æµ‹æœªæš‚å­˜æ›´æ”¹å¹¶æç¤ºç”¨æˆ·ç¡®è®¤
- ğŸ” **å®‰å…¨ä¼˜å…ˆ** - æ”¯æŒç¯å¢ƒå˜é‡å­˜å‚¨ API å¯†é’¥ï¼Œé¿å…æ˜æ–‡å­˜å‚¨

## ğŸ“¦ å®‰è£…

### ä»æºç ç¼–è¯‘

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/yourusername/rust-git-cli.git
cd rust-git-cli

# ç¼–è¯‘å‘å¸ƒç‰ˆæœ¬
cargo build --release

# å®‰è£…åˆ°ç³»ç»Ÿï¼ˆå¯é€‰ï¼‰
cargo install --path .

# å¯æ‰§è¡Œæ–‡ä»¶ä½äº
./target/release/rust-git-cli
```

### ç³»ç»Ÿè¦æ±‚

- Rust 1.70+
- Git 2.0+

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åˆå§‹åŒ–é…ç½®

```bash
# åœ¨ç”¨æˆ·ç›®å½•åˆ›å»ºå…¨å±€é…ç½®
rust-git-cli init

# æˆ–åœ¨å½“å‰é¡¹ç›®åˆ›å»ºæœ¬åœ°é…ç½®
rust-git-cli init --local
```

### 2. è®¾ç½® API Key

```bash
# æ–¹å¼ä¸€ï¼šç¯å¢ƒå˜é‡ï¼ˆæ¨èï¼‰
export OPENAI_API_KEY="your-api-key"

# æ–¹å¼äºŒï¼šé…ç½®æ–‡ä»¶
# ç¼–è¾‘ ~/.config/rust-git-cli/config.toml
```

### 3. ä½¿ç”¨å·¥å…·

```bash
# æŸ¥çœ‹ä»“åº“çŠ¶æ€
rust-git-cli

# ç”Ÿæˆ AI æäº¤ä¿¡æ¯
rust-git-cli commit

# æ˜¾ç¤ºå·®å¼‚åå†ç”Ÿæˆ
rust-git-cli commit --show-diff

# è°ƒè¯•æ¨¡å¼ï¼ˆæ˜¾ç¤º AI åŸå§‹å“åº”ï¼‰
rust-git-cli commit --debug
```

## ğŸ“– ä½¿ç”¨æŒ‡å—

### åŸºæœ¬å‘½ä»¤

#### çŠ¶æ€æ£€æŸ¥
```bash
# æ£€æŸ¥å½“å‰ç›®å½•
rust-git-cli
rust-git-cli status

# æ£€æŸ¥æŒ‡å®šç›®å½•
rust-git-cli -p /path/to/repo

# è¯¦ç»†è¾“å‡º
rust-git-cli -v
```

#### æŸ¥çœ‹å·®å¼‚
```bash
# æŸ¥çœ‹æ‰€æœ‰ä¿®æ”¹
rust-git-cli diff

# ä»…æŸ¥çœ‹å·²æš‚å­˜çš„ä¿®æ”¹
rust-git-cli diff --staged
```

#### AI æäº¤
```bash
# åŸºæœ¬ä½¿ç”¨
rust-git-cli commit

# æŒ‡å®š API keyï¼ˆä¸´æ—¶ï¼‰
rust-git-cli commit --api-key YOUR_KEY

# ä½¿ç”¨ç‰¹å®šæ¨¡å‹
rust-git-cli commit --model gpt-4
rust-git-cli commit --model deepseek-v3

# è‡ªåŠ¨æäº¤ï¼ˆè·³è¿‡ç¡®è®¤ï¼‰
rust-git-cli commit --auto

# æ˜¾ç¤ºå·®å¼‚é¢„è§ˆ
rust-git-cli commit --show-diff

# è°ƒè¯•æ¨¡å¼
rust-git-cli commit --debug
```

### æ™ºèƒ½æš‚å­˜åŠŸèƒ½

å½“æ‰§è¡Œ `rust-git-cli commit` æ—¶ï¼Œå·¥å…·ä¼šè‡ªåŠ¨æ£€æµ‹æœªæš‚å­˜çš„æ›´æ”¹ï¼š

```bash
$ rust-git-cli commit

Unstaged changes detected:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  M src/main.rs
  ? src/new_file.rs
  D src/old_file.rs
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Do you want to stage all changes (git add .)? (Y/n)
```

- é€‰æ‹© **Yes**ï¼šæ‰§è¡Œ `git add .` æš‚å­˜æ‰€æœ‰æ›´æ”¹
- é€‰æ‹© **No**ï¼šä»…æäº¤å½“å‰å·²æš‚å­˜çš„æ›´æ”¹

### é…ç½®æ–‡ä»¶

é…ç½®æ–‡ä»¶æŸ¥æ‰¾é¡ºåºï¼š
1. å½“å‰ç›®å½• `.rust-git-cli.toml`
2. `~/.config/rust-git-cli/config.toml`
3. `~/.rust-git-cli.toml`

#### é…ç½®ç¤ºä¾‹

```toml
[ai]
# AI æä¾›å•†ï¼šopenai æˆ– anthropic
provider = "openai"

# æ¨¡å‹åç§°
model = "deepseek-v3"  # æˆ– gpt-4, claude-3-opus ç­‰

# API Key ç¯å¢ƒå˜é‡å
api_key_env = "OPENAI_API_KEY"

# ç›´æ¥è®¾ç½® API Keyï¼ˆä¸æ¨èï¼‰
# api_key = "sk-..."

# è‡ªå®šä¹‰ API ç«¯ç‚¹ï¼ˆç”¨äºä»£ç†æˆ–ç§æœ‰éƒ¨ç½²ï¼‰
base_url = "https://api.deepseek.com/v1"

[commit]
# æäº¤ä¿¡æ¯æ ¼å¼
format = "conventional"

# æ˜¯å¦åŒ…å« emoji
include_emoji = false

# å‘é€ç»™ AI çš„æœ€å¤§å·®å¼‚å¤§å°
max_diff_size = 4000

# æ˜¯å¦è‡ªåŠ¨æš‚å­˜æ‰€æœ‰æ›´æ”¹
auto_stage = false
```

### API Key é…ç½®ä¼˜å…ˆçº§

1. **å‘½ä»¤è¡Œå‚æ•°**ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
   ```bash
   rust-git-cli commit --api-key YOUR_KEY
   ```

2. **é…ç½®æ–‡ä»¶**
   ```toml
   api_key = "your-key"
   ```

3. **ç¯å¢ƒå˜é‡**
   ```bash
   export OPENAI_API_KEY="your-key"
   export ANTHROPIC_API_KEY="your-key"
   ```

4. **äº¤äº’å¼è¾“å…¥**ï¼ˆæœ€ä½ä¼˜å…ˆçº§ï¼‰

## ğŸŒ åŒè¯­æäº¤ä¿¡æ¯

å·¥å…·ä¼šç”Ÿæˆç¬¦åˆ Conventional Commits è§„èŒƒçš„ä¸­è‹±æ–‡åŒè¯­æäº¤ä¿¡æ¯ï¼š

### æ ¼å¼ç¤ºä¾‹

```
feat(auth): æ·»åŠ ç”¨æˆ·è®¤è¯åŠŸèƒ½
Add user authentication feature

å®ç°äº†JWTä»¤ç‰ŒéªŒè¯
Implement JWT token validation
æ·»åŠ äº†ç”¨æˆ·ç™»å½•æ¥å£
Add user login endpoint
é›†æˆäº†OAuth2.0æ”¯æŒ
Integrate OAuth2.0 support
```

### å·¥ä½œæµç¨‹ç¤ºä¾‹

#### å®Œæ•´çš„æäº¤æµç¨‹

```bash
# 1. æŸ¥çœ‹å½“å‰çŠ¶æ€
$ rust-git-cli status

# 2. æŸ¥çœ‹å…·ä½“æ›´æ”¹
$ rust-git-cli diff

# 3. ç”Ÿæˆå¹¶æäº¤
$ rust-git-cli commit

# å¦‚æœæœ‰æœªæš‚å­˜çš„æ›´æ”¹ï¼Œä¼šæç¤ºï¼š
# Unstaged changes detected:
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#   M src/main.rs
#   ? src/new_feature.rs
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Do you want to stage all changes (git add .)? (Y/n)

# 4. AI ç”Ÿæˆæäº¤ä¿¡æ¯åï¼Œé€‰æ‹©æ“ä½œï¼š
# - Accept and commitï¼šæ¥å—å¹¶æäº¤
# - Edit messageï¼šç¼–è¾‘æ¶ˆæ¯
# - Regenerateï¼šé‡æ–°ç”Ÿæˆ
# - Cancelï¼šå–æ¶ˆ
```

#### é«˜çº§ç”¨æ³•

```bash
# æŸ¥çœ‹å·®å¼‚åå†å†³å®šæ˜¯å¦ç”Ÿæˆæäº¤
rust-git-cli commit --show-diff

# è°ƒè¯• AI å“åº”é—®é¢˜
rust-git-cli commit --debug

# è·³è¿‡æ‰€æœ‰ç¡®è®¤ï¼ˆCI/CD ç¯å¢ƒï¼‰
rust-git-cli commit --auto
```

### æäº¤ç±»å‹

- `feat`: æ–°åŠŸèƒ½
- `fix`: ä¿®å¤ bug
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼è°ƒæ•´ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰
- `refactor`: ä»£ç é‡æ„
- `test`: æµ‹è¯•ç›¸å…³
- `chore`: æ„å»ºæˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨
- `perf`: æ€§èƒ½ä¼˜åŒ–

## ğŸ› è°ƒè¯•åŠŸèƒ½

ä½¿ç”¨ `--debug` æ ‡å¿—å¯ä»¥æŸ¥çœ‹ AI çš„åŸå§‹å“åº”ï¼Œæ–¹ä¾¿æ’æŸ¥é—®é¢˜ï¼š

```bash
rust-git-cli commit --debug
```

è°ƒè¯•æ¨¡å¼ä¼šæ˜¾ç¤ºï¼š
- åŸå§‹ HTTP å“åº”
- AI è¿”å›çš„ JSON å†…å®¹
- è§£æå‰çš„æ¶ˆæ¯å†…å®¹

## ğŸ’» å¼€å‘

### å¼€å‘å‘½ä»¤

```bash
# è¿è¡Œæµ‹è¯•
cargo test

# ä»£ç æ ¼å¼åŒ–
cargo fmt

# ä»£ç æ£€æŸ¥
cargo clippy

# è‡ªåŠ¨ä¿®å¤
cargo fix

# å¼€å‘æ¨¡å¼è¿è¡Œ
cargo run -- commit
```

### é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ main.rs        # ç¨‹åºå…¥å£å’Œå‘½ä»¤åˆ†å‘
â”œâ”€â”€ cli.rs         # å‘½ä»¤è¡Œå‚æ•°å®šä¹‰
â”œâ”€â”€ config.rs      # é…ç½®æ–‡ä»¶ç®¡ç†
â”œâ”€â”€ git.rs         # Git æ“ä½œå°è£…
â”œâ”€â”€ ui.rs          # ç”¨æˆ·äº¤äº’ç•Œé¢
â””â”€â”€ ai/
    â”œâ”€â”€ mod.rs     # AI å®¢æˆ·ç«¯æ¥å£
    â”œâ”€â”€ openai.rs  # OpenAI å®ç°
    â””â”€â”€ anthropic.rs # Anthropic å®ç°
```

## ğŸ” å®‰å…¨æœ€ä½³å®è·µ

### API å¯†é’¥ç®¡ç†

1. **æ¨èï¼šä½¿ç”¨ç¯å¢ƒå˜é‡**
   ```bash
   export OPENAI_API_KEY="your-api-key"
   ```

2. **é¿å…ï¼šç›´æ¥åœ¨é…ç½®æ–‡ä»¶ä¸­å­˜å‚¨ API å¯†é’¥**
   - å¦‚æœå¿…é¡»ä½¿ç”¨é…ç½®æ–‡ä»¶ï¼Œç¡®ä¿æ–‡ä»¶æƒé™è®¾ç½®ä¸º 600
   - æ°¸è¿œä¸è¦å°†åŒ…å« API å¯†é’¥çš„é…ç½®æ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶

3. **ä¸´æ—¶ä½¿ç”¨ï¼šå‘½ä»¤è¡Œå‚æ•°**
   ```bash
   rust-git-cli commit --api-key YOUR_KEY
   ```

### å·¥ä½œæµç¨‹å»ºè®®

1. **å®¡æŸ¥ç”Ÿæˆçš„æäº¤ä¿¡æ¯**
   - å§‹ç»ˆæ£€æŸ¥ AI ç”Ÿæˆçš„æäº¤ä¿¡æ¯æ˜¯å¦å‡†ç¡®
   - ä½¿ç”¨ç¼–è¾‘åŠŸèƒ½ä¿®æ­£ä¸å‡†ç¡®çš„æè¿°

2. **åˆç†çš„å·®å¼‚å¤§å°**
   - ä¿æŒå•æ¬¡æäº¤çš„æ›´æ”¹é‡é€‚ä¸­
   - é»˜è®¤æœ€å¤§å·®å¼‚å¤§å°ä¸º 4000 å­—ç¬¦ï¼Œå¯åœ¨é…ç½®ä¸­è°ƒæ•´

3. **ä½¿ç”¨æš‚å­˜åŒº**
   - åˆ©ç”¨ Git æš‚å­˜åŒºç²¾ç¡®æ§åˆ¶æäº¤å†…å®¹
   - å·¥å…·ä¼šæç¤ºä½ æ˜¯å¦è¦æš‚å­˜æ‰€æœ‰æ›´æ”¹

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **API è¿æ¥å¤±è´¥**
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - éªŒè¯ API key æ˜¯å¦æ­£ç¡®
   - ä½¿ç”¨ `--debug` æŸ¥çœ‹è¯¦ç»†é”™è¯¯
   - ç¡®è®¤ API ç«¯ç‚¹æ˜¯å¦æ­£ç¡®ï¼ˆç‰¹åˆ«æ˜¯ä½¿ç”¨ä»£ç†æ—¶ï¼‰

2. **JSON è§£æé”™è¯¯**
   - ä½¿ç”¨ `--debug` æŸ¥çœ‹ AI è¿”å›çš„åŸå§‹å†…å®¹
   - æ£€æŸ¥æ¨¡å‹æ˜¯å¦æ”¯æŒ JSON æ ¼å¼è¾“å‡º
   - å°è¯•æ›´æ¢æ¨¡å‹

3. **é…ç½®æ–‡ä»¶æœªç”Ÿæ•ˆ**
   - æ£€æŸ¥é…ç½®æ–‡ä»¶ä½ç½®æ˜¯å¦æ­£ç¡®
   - éªŒè¯ TOML æ ¼å¼æ˜¯å¦æœ‰æ•ˆ
   - æ³¨æ„ `api_key_env` æ˜¯ç¯å¢ƒå˜é‡åï¼Œä¸æ˜¯ key æœ¬èº«

4. **æäº¤å¤±è´¥**
   - ç¡®ä¿ Git ç”¨æˆ·å·²é…ç½®ï¼ˆ`git config user.name` å’Œ `user.email`ï¼‰
   - æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶æƒé™é—®é¢˜
   - æŸ¥çœ‹å…·ä½“çš„ Git é”™è¯¯ä¿¡æ¯

### è·å–å¸®åŠ©

```bash
# æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯
rust-git-cli --help
rust-git-cli commit --help
```

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ™ è‡´è°¢

- [git2-rs](https://github.com/rust-lang/git2-rs) - Git æ“ä½œ
- [clap](https://github.com/clap-rs/clap) - å‘½ä»¤è¡Œè§£æ
- [dialoguer](https://github.com/console-rs/dialoguer) - äº¤äº’å¼ç•Œé¢
- [colored](https://github.com/colored-rs/colored) - å½©è‰²è¾“å‡º